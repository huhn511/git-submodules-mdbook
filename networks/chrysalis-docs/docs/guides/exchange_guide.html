<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js iota">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Exchange - IOTA Documentation</title>
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        <link rel="icon" href="../../../../favicon.svg">
        
        
        <link rel="shortcut icon" href="../../../../favicon.png">
        
        <link rel="stylesheet" href="../../../../css/variables.css">
        <link rel="stylesheet" href="../../../../css/general.css">
        <link rel="stylesheet" href="../../../../css/chrome.css">
        
        <link rel="stylesheet" href="../../../../css/print.css" media="print">
        

        <!-- Fonts -->
        <link rel="stylesheet" href="../../../../FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="../../../../fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../../../highlight.css">
        <link rel="stylesheet" href="../../../../tomorrow-night.css">
        <link rel="stylesheet" href="../../../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
        <link rel="stylesheet" href="../../../../open-in.css">
        
        <link rel="stylesheet" href="../../../.././theme/custom/sidebar.css">
        

        

        <script src='../../../../public/build/bundle.js'></script>

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../../../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "iota";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('iota')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../../../../docs/welcome.html"><strong aria-hidden="true">1.</strong> Welcome</a></li><li class="chapter-item expanded "><a href="../../../../networks/index.html"><strong aria-hidden="true">2.</strong> Networks</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../networks/chrysalis-docs/docs/introduction/welcome.html"><strong aria-hidden="true">2.1.</strong> Chrysalis</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../networks/chrysalis-docs/docs/introduction/what_is_chrysalis.html"><strong aria-hidden="true">2.1.1.</strong> What is Chrysalis?</a></li><li class="chapter-item expanded "><a href="../../../../networks/chrysalis-docs/docs/introduction/path_to_chrysalis.html"><strong aria-hidden="true">2.1.2.</strong> Path to Chrysalis</a></li><li class="chapter-item expanded "><a href="../../../../networks/chrysalis-docs/docs/node-software/node-software.html"><strong aria-hidden="true">2.1.3.</strong> Node Software</a></li><li class="chapter-item expanded "><a href="../../../../networks/chrysalis-docs/docs/libraries/overview.html"><strong aria-hidden="true">2.1.4.</strong> Libraries</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../networks/chrysalis-docs/docs/libraries/client.html"><strong aria-hidden="true">2.1.4.1.</strong> Client Lib</a></li><li class="chapter-item expanded "><a href="../../../../networks/chrysalis-docs/docs/libraries/wallet.html"><strong aria-hidden="true">2.1.4.2.</strong> Wallet Lib</a></li></ol></li><li class="chapter-item expanded "><a href="../../../../networks/chrysalis-docs/docs/guides/index.html"><strong aria-hidden="true">2.1.5.</strong> Guides</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../networks/chrysalis-docs/docs/guides/dev_guide.html"><strong aria-hidden="true">2.1.5.1.</strong> Developer</a></li><li class="chapter-item expanded "><a href="../../../../networks/chrysalis-docs/docs/guides/exchange_guide.html" class="active"><strong aria-hidden="true">2.1.5.2.</strong> Exchange</a></li><li class="chapter-item expanded "><a href="../../../../networks/chrysalis-docs/docs/guides/hub_guide.html"><strong aria-hidden="true">2.1.5.3.</strong> Hub Migration</a></li><li class="chapter-item expanded "><a href="../../../../networks/chrysalis-docs/docs/guides/backup_security.html"><strong aria-hidden="true">2.1.5.4.</strong> Backup and Security</a></li></ol></li><li class="chapter-item expanded "><a href="../../../../networks/chrysalis-docs/docs/testnet.html"><strong aria-hidden="true">2.1.6.</strong> Testnet</a></li><li class="chapter-item expanded "><a href="../../../../networks/chrysalis-docs/docs/rfc.html"><strong aria-hidden="true">2.1.7.</strong> Protocol RFCs</a></li><li class="chapter-item expanded "><a href="../../../../networks/chrysalis-docs/docs/resources.html"><strong aria-hidden="true">2.1.8.</strong> Resources</a></li><li class="chapter-item expanded "><a href="../../../../networks/chrysalis-docs/docs/faq.html"><strong aria-hidden="true">2.1.9.</strong> FAQ</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../../../libraries/index.html"><strong aria-hidden="true">3.</strong> Libraries</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../libraries/client-lib/docs/welcome.html"><strong aria-hidden="true">3.1.</strong> client-lib</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../libraries/client-lib/docs/overview/index.html"><strong aria-hidden="true">3.1.1.</strong> Overview</a></li><li class="chapter-item expanded "><a href="../../../../libraries/client-lib/docs/libraries/index.html"><strong aria-hidden="true">3.1.2.</strong> Libraries</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../libraries/client-lib/docs/libraries/rust/index.html"><strong aria-hidden="true">3.1.2.1.</strong> Rust</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../libraries/client-lib/docs/libraries/rust/getting_started.html"><strong aria-hidden="true">3.1.2.1.1.</strong> Getting Started</a></li><li class="chapter-item expanded "><a href="../../../../libraries/client-lib/docs/libraries/rust/examples.html"><strong aria-hidden="true">3.1.2.1.2.</strong> Examples</a></li><li class="chapter-item expanded "><a href="../../../../libraries/client-lib/docs/libraries/rust/api_reference.html"><strong aria-hidden="true">3.1.2.1.3.</strong> API Reference</a></li><li class="chapter-item expanded "><a href="../../../../libraries/client-lib/docs/libraries/rust/troubleshooting.html"><strong aria-hidden="true">3.1.2.1.4.</strong> Troubleshooting</a></li></ol></li><li class="chapter-item expanded "><a href="../../../../libraries/client-lib/docs/libraries/nodejs/index.html"><strong aria-hidden="true">3.1.2.2.</strong> Node.js</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../libraries/client-lib/docs/libraries/nodejs/getting_started.html"><strong aria-hidden="true">3.1.2.2.1.</strong> Getting Started</a></li><li class="chapter-item expanded "><a href="../../../../libraries/client-lib/docs/libraries/nodejs/examples.html"><strong aria-hidden="true">3.1.2.2.2.</strong> Examples</a></li><li class="chapter-item expanded "><a href="../../../../libraries/client-lib/docs/libraries/nodejs/api_reference.html"><strong aria-hidden="true">3.1.2.2.3.</strong> API Reference</a></li><li class="chapter-item expanded "><a href="../../../../libraries/client-lib/docs/libraries/nodejs/troubleshooting.html"><strong aria-hidden="true">3.1.2.2.4.</strong> Troubleshooting</a></li></ol></li><li class="chapter-item expanded "><a href="../../../../libraries/client-lib/docs/libraries/python/index.html"><strong aria-hidden="true">3.1.2.3.</strong> Python</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../libraries/client-lib/docs/libraries/python/getting_started.html"><strong aria-hidden="true">3.1.2.3.1.</strong> Getting Started</a></li><li class="chapter-item expanded "><a href="../../../../libraries/client-lib/docs/libraries/python/examples.html"><strong aria-hidden="true">3.1.2.3.2.</strong> Examples</a></li><li class="chapter-item expanded "><a href="../../../../libraries/client-lib/docs/libraries/python/api_reference.html"><strong aria-hidden="true">3.1.2.3.3.</strong> API Reference</a></li><li class="chapter-item expanded "><a href="../../../../libraries/client-lib/docs/libraries/python/troubleshooting.html"><strong aria-hidden="true">3.1.2.3.4.</strong> Troubleshooting</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../../../libraries/client-lib/docs/specs/index.html"><strong aria-hidden="true">3.1.3.</strong> Specification</a></li><li class="chapter-item expanded "><a href="../../../../libraries/client-lib/docs/contribute.html"><strong aria-hidden="true">3.1.4.</strong> Contribute</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../../../node-software/index.html"><strong aria-hidden="true">4.</strong> Node Software</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../node-software/hornet/docs/welcome.html"><strong aria-hidden="true">4.1.</strong> HORNET</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../node-software/hornet/docs/tutorials/index.html"><strong aria-hidden="true">4.1.1.</strong> Tutorials</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../node-software/hornet/docs/tutorials/1.0/index.html"><strong aria-hidden="true">4.1.1.1.</strong> IOTA 1.0</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../node-software/hornet/docs/tutorials/1.0/setup.html"><strong aria-hidden="true">4.1.1.1.1.</strong> Setup HORNET</a></li><li class="chapter-item expanded "><a href="../../../../node-software/hornet/docs/tutorials/1.0/private_tangle.html"><strong aria-hidden="true">4.1.1.1.2.</strong> Run a private Tangle</a></li><li class="chapter-item expanded "><a href="../../../../node-software/hornet/docs/tutorials/1.0/entry_node.html"><strong aria-hidden="true">4.1.1.1.3.</strong> Hosting An Entry Node</a></li></ol></li><li class="chapter-item expanded "><a href="../../../../node-software/hornet/docs/tutorials/1.5/index.html"><strong aria-hidden="true">4.1.1.2.</strong> Chrysalis IOTA 1.5</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../node-software/hornet/docs/tutorials/1.5/build.html"><strong aria-hidden="true">4.1.1.2.1.</strong> Build HORNET</a></li><li class="chapter-item expanded "><a href="../../../../node-software/hornet/docs/tutorials/1.5/run.html"><strong aria-hidden="true">4.1.1.2.2.</strong> Run HORNET</a></li><li class="chapter-item expanded "><a href="../../../../node-software/hornet/docs/tutorials/1.5/private_tangle.html"><strong aria-hidden="true">4.1.1.2.3.</strong> Run a private tangle</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../../../node-software/hornet/docs/configuration/index.html"><strong aria-hidden="true">4.1.2.</strong> Configuration</a></li><li class="chapter-item expanded "><a href="../../../../node-software/hornet/docs/configuration/config.html"><strong aria-hidden="true">4.1.3.</strong> config.json</a></li><li class="chapter-item expanded "><a href="../../../../node-software/hornet/docs/configuration/peering.html"><strong aria-hidden="true">4.1.4.</strong> peering.json</a></li><li class="chapter-item expanded "><a href="../../../../node-software/hornet/docs/api-reference.html"><strong aria-hidden="true">4.1.5.</strong> API Reference</a></li><li class="chapter-item expanded "><a href="../../../../node-software/hornet/docs/troubleshooting.html"><strong aria-hidden="true">4.1.6.</strong> Troubleshooting</a></li><li class="chapter-item expanded "><a href="../../../../faq.html"><strong aria-hidden="true">4.1.7.</strong> FAQ</a></li><li class="chapter-item expanded "><a href="../../../../node-software/hornet/docs/Contribution.html"><strong aria-hidden="true">4.1.8.</strong> Contribution</a></li><li class="chapter-item expanded "><a href="../../../../node-software/hornet/docs/code_of_conduct.html"><strong aria-hidden="true">4.1.9.</strong> Code of Conduct</a></li></ol></li><li class="chapter-item expanded "><a href="../../../../node-software/Bee/docs/welcome.html"><strong aria-hidden="true">4.2.</strong> Bee</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../node-software/Bee/docs/overview.html"><strong aria-hidden="true">4.2.1.</strong> Overview</a></li><li class="chapter-item expanded "><a href="../../../../node-software/Bee/docs/node/index.html"><strong aria-hidden="true">4.2.2.</strong> Setup a Node</a></li><li class="chapter-item expanded "><a href="../../../../node-software/Bee/docs/contribution.html"><strong aria-hidden="true">4.2.3.</strong> Contribution</a></li></ol></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="iota">IOTA (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">IOTA Documentation</h1>

                    <div class="right-buttons">
                        
                        <a href="../../../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        
                        <a href="https://github.com/huhn511/git-submodules-mdbook" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="exchange-guide"><a class="header" href="#exchange-guide">Exchange guide</a></h1>
<h2 id="the-iota-wallet-library"><a class="header" href="#the-iota-wallet-library">The IOTA wallet library</a></h2>
<blockquote>
<p>Easily integrate IOTA with your exchange, custody solution, or product.</p>
</blockquote>
<p>IOTA is built on an architecture that was designed to be the backbone of the Internet of Things (IoT) environment of the future. But this architecture has made it more challenging for service providers like exchanges to integrate IOTA compared to traditional blockchain-based distributed ledgers.</p>
<p>Within the Chrysalis update (also known as IOTA 1.5), some building blocks have been changed to be more approachable and more aligned with currently leveraged standards. We also ship many <a href="../libraries/overview.html">client libraries</a> to help developers implement IOTA into their applications:
<img src="assets/wallet_rs_layers.svg" alt="layers" /></p>
<h2 id="how-do-i-implement-it-to-my-exchange"><a class="header" href="#how-do-i-implement-it-to-my-exchange">How do I implement it to my exchange?</a></h2>
<p>In <a href="../libraries/wallet.html">wallet.rs</a>, we use an account model so you can create an account for each of your users. Another approach would be to use one account and generate multiple addresses, which you can then link to the users in your database. The wallet library is designed to be as flexible as possible to back up any of your use cases.</p>
<p>Since IOTA addresses in the Chrysalis network are perfectly reusable, they can be mapped to your users in a clear and concise way:</p>
<ul>
<li>Create an account for every user -&gt; <code>Multi Account</code> approach</li>
<li>Create one account with many addresses -&gt; <code>Single account</code> approach</li>
</ul>
<p>The library supports derivation for multiple accounts from a single seed. An account is simply a deterministic identifier from which multiple addresses can be further derived. </p>
<p>The library also allows consumers to assign a meaningful alias to each account. In addition to this, generated individual accounts can be also searched via generated addresses. This means it does not matter whether aliases or addresses are known as the search for the related account is very straightforward using the <code>wallet.rs</code> library.</p>
<p>It also leaves the choice to users if they want to segregate their funds across multiple accounts or multiple addresses. The following illustration outlines the relationships between seed, accounts, and addresses: </p>
<p><img src="assets/accounts.svg" alt="accounts" /></p>
<h3 id="multi-account-approach"><a class="header" href="#multi-account-approach">Multi account approach</a></h3>
<p>The multi account approach is used to create an account for each individual user. The created accounts can then be linked to the internal user IDs as an account alias, which are distinctly separated.</p>
<h3 id="single-account-approach"><a class="header" href="#single-account-approach">Single account approach</a></h3>
<p>The single account approach allows for just one account and creates addresses for each individual user. The associated addresses are then linked to the internal user IDs and store who owns which address in the database. Most exchanges are more familiar with the single account approach and find it easier to use, implement, and backup.</p>
<h2 id="implementation-guide"><a class="header" href="#implementation-guide">Implementation guide</a></h2>
<p>This guide explains how to use the IOTA Wallet Library to successfully implement IOTA into an exchange. If you already implemented the IOTA Hub, please visit the <a href="./hub_guide.html">Hub Migration Guide</a>.</p>
<p>Features of the Wallet Library:</p>
<ul>
<li>Secure seed management</li>
<li>Account management (with multiple accounts and multiple addresses)</li>
<li>Confirmation monitoring</li>
<li>Deposit address monitoring</li>
<li>Backup and restore functionality</li>
</ul>
<h2 id="how-does-it-work"><a class="header" href="#how-does-it-work">How does it work?</a></h2>
<p>The Wallet Library is a stateful package with a standardized interface for developers to build applications involving IOTA value transactions. It offers abstractions to handle IOTA payments and can optionally interact with the IOTA Stronghold for seed handling, seed storage, and state backup. Alternatively, you can use a SQLite database; however, using the Stronghold component is highly recommended due to the most advanced level of security being applied.</p>
<p>For reference, you can see the <a href="https://wallet-lib.docs.iota.org">full documentation here</a>.</p>
<p>The following examples cover the <em>multi account approach</em> using <code>NodeJS</code> binding:</p>
<ol>
<li>Setup the Wallet Library</li>
<li>Create an account for each user</li>
<li>Generate a user address for deposits</li>
<li>Listen to events</li>
<li>Check the user balance</li>
<li>Enable withdrawals</li>
</ol>
<p><em>Note: If you are looking for other languages, please read the <a href="/libraries/wallet.html">wallet library overview</a>.</em></p>
<p>Since all <code>wallet.rs</code> bindings are based on core principles provided by the <code>wallet.rs</code> library, the outlined approach is very similar regardless of the programming language of your choice.</p>
<h3 id="1-setup-the-wallet-library"><a class="header" href="#1-setup-the-wallet-library">1. Setup the Wallet library</a></h3>
<p>First, let's install the components that are needed to use <code>wallet.rs</code> and the binding of your choice; it may vary a bit from language to language. In the case of the <code>NodeJs</code> binding, it is quite straightforward since it is distributed via the <code>npm</code> package manager. We also recommend you use <code>dotenv</code> for password management.</p>
<p>For reference, read more about <a href="backup_security.html">backup and security here</a>.</p>
<pre><code class="language-bash">npm install @iota/wallet dotenv
touch .env
</code></pre>
<p>Then, input your password to the <code>.env</code> file like this:</p>
<pre><code class="language-bash">SH_PASSWORD=&quot;here is your super secure password&quot;
</code></pre>
<p>Once you have everything needed to use the <code>wallet.rs</code> library, it is necessary to initialize the <code>AccountManager</code> instance which creates (opens) a secure storage for individual accounts (backed up by <code>Stronghold</code> by default).</p>
<p>The storage is encrypted at rest, so you need a strong password and location where to put your storage. </p>
<p><em>Note: manage your password with the utmost care</em>.</p>
<p>Technically speaking, &quot;storage&quot; means a single file called <code>wallet.stronghold</code>. It is also needed to generate a seed (mnemonic) that serves as a cryptographic key from which all accounts and related addresses are generated.</p>
<p>One of the key principles behind the <code>stronghold</code>-based storage is that no one can get a seed from the storage. You deal with all the accounts purely via the <code>Account_Manager</code> instance where all complexities are hidden under the hood and are dealt with in a secure way. In case you would also like to store a seed somewhere else, there is another method, <code>AccountManager.generateMnemonic()</code>, that generates random seeds. This method can be leveraged before the actual account initialization.</p>
<p>Note that it is highly recommended to store the <code>stronghold</code> password and the <code>stronghold</code> database on separate devices. Please refer to the <a href="backup_security.html">backup and security guide</a> for more information.</p>
<p>Import the Wallet Library and create an account manager:</p>
<pre><code class="language-javascript">    const { AccountManager, SignerType } = require('@iota/wallet')

    // Setup IOTA Wallet Library
    const manager = new AccountManager({
        storagePath: './storage'
    })
    manager.setStrongholdPassword(process.env.SH_PASSWORD)
    manager.storeMnemonic(SignerType.Stronghold, manager.generateMnemonic()) // seed generation
</code></pre>
<p>Once the stronghold storage is created, it is not needed to generate the seed any longer (<code>manager.storeMnemonic(SignerType.Stronghold, manager.generateMnemonic())</code>). It has been already saved in the storage together with all account information.</p>
<h3 id="2-create-an-account-for-an-user"><a class="header" href="#2-create-an-account-for-an-user">2. Create an account for an user</a></h3>
<p>Once the backend storage is created, individual accounts for individual users can be created:</p>
<pre><code class="language-javascript">    let account = await manager.createAccount({
        alias: user_id,  // an unique id from your existing user
        clientOptions: { node: 'http://api.lb-0.testnet.chrysalis2.com', localPow: false }
    })
</code></pre>
<p>Each account is related to a specific IOTA network (mainnet/devnet) which is referenced by a node property, such as node url (in this example, the Chrysalis testnet balancer).</p>
<p>For more information about <code>clientOptions</code>, please refer to <a href="https://wallet-lib.docs.iota.org/libraries/nodejs/api_reference.html">Wallet NodeJs API Reference</a>.</p>
<p>The <code>Alias</code> can be whatever fits to the given use case and should be unique. The <code>alias</code> is usually used to identify the given account later on. Each account is also represented by an <code>index</code> which is incremented (by 1) every time a new account is created. Any account can be then referred to via <code>index</code>, <code>alias</code>, or one of its generated <code>addresses</code>.</p>
<p>Once an account has been created, you get an instance of it using the following methods: <code>AccountManager.getAccount(accountId)</code>, <code>AccountManager.getAccountByAlias(alias)</code> or <code>AccountManager.getAccounts()</code>.</p>
<p>The most common methods of <code>account</code> instance include:</p>
<ul>
<li><code>account.alias()</code> - returns an alias of the given account</li>
<li><code>account.listAddresses()</code> - returns list of addresses related to the account</li>
<li><code>account.getUnusedAddress()</code> - returns a first unused address</li>
<li><code>account.generateAddress()</code> - generate a new address for the address index incremented by 1</li>
<li><code>account.balance()</code> - returns the balance for the given account</li>
<li><code>account.sync()</code> - sync the account information with the tangle</li>
</ul>
<h3 id="3-generate-a-user-address-to-deposit-funds"><a class="header" href="#3-generate-a-user-address-to-deposit-funds">3. Generate a user address to deposit funds</a></h3>
<p><code>Wallet.rs</code> is a stateful library which means it caches all relevant information in storage to provide performance benefits while dealing with, potentially, many accounts/addresses.</p>
<p><em>Note: sync the account info with the network during the wallet manipulation to be sure the storage reflects an actual state of the ledger (network)</em>. </p>
<p>Every account can own multiple addresses. Addresses are represented by an <code>index</code> which is incremented (by 1) every time a new address is created. The latest address is accessible via <code>account.latestAddress()</code>: </p>
<pre><code class="language-javascript">    // Always sync before account interactions
    console.log('syncing...')
    const synced = await account.sync()
    console.log('synced!')

    // By design, the last address of each account is an unused address which can be used as deposit address
    const latestAddress = account.latestAddress()

    console.log('Need a refill? Send it to this address:', latestAddress)
</code></pre>
<p>Feel free to fill the address with Testnet Tokens with the <a href="https://faucet.testnet.chrysalis2.com/">IOTA Faucet</a> to test it.</p>
<p>Addresses are of two types, <code>internal</code> and <code>public</code> (external):</p>
<ul>
<li>Each set of addresses are independent from each other and has an independent <code>index</code> id</li>
<li>Addresses that are created by <code>account.generateAddress()</code> are indicated as <code>internal=false</code> (public)</li>
<li>Internal addresses (<code>internal=true</code>) are called <code>change</code> addresses and are used to send the excess funds to them</li>
<li>The approach is also known as a <em>BIP32 Hierarchical Deterministic wallet (HD Wallet)</em></li>
</ul>
<p><em>Note: You may remember IOTA 1.0 network in which addresses were not reusable. It is no longer true and addresses can be reused multiple times in IOTA 1.5 (Chrysalis) network.</em></p>
<h3 id="4-listen-to-events"><a class="header" href="#4-listen-to-events">4. Listen to events</a></h3>
<p>The <code>Wallet.rs</code> library supports several events for listening. As soon as the given event occurs, a provided callback is triggered.</p>
<p>Below is an example of fetching existing accounts and listening to transaction events coming into the account:</p>
<pre><code class="language-javascript">    const { addEventListener } = require('@iota/wallet')

    const callback = function(err, data) {
        if(err) console.log(&quot;err:&quot;, err)
        console.log(&quot;data:&quot;, data)
    }

    //Adds a new event listener with a callback in the form of (err, data) =&gt; {}. Supported event names:
    addEventListener(&quot;BalanceChange&quot;, callback)

    // Possible Event Types:
    //
    // ErrorThrown
    // BalanceChange
    // NewTransaction
    // ConfirmationStateChange
    // Reattachment
    // Broadcast

</code></pre>
<p>Example output:</p>
<pre><code class="language-bash">data: {
  accountId: 'wallet-account://1666fc60fc95534090728a345cc5a861301428f68a237bea2b5ba0c844988566',
  address: {
    address: 'atoi1q9c6r2ek5w2yz54en78m8dxwl4qmwd7gmh9u0krm45p8txxyhtfry6apvwj',
    balance: 20000000,
    keyIndex: 0,
    internal: false,
    outputs: [ [Object], [Object] ]
  },
  balance: 20000000
}
</code></pre>
<p><code>accountId</code> can then be used to identify the given account via <code>AccountManager.getAccount(accountId)</code>.</p>
<p>For reference, you can read more about events in the <a href="https://wallet-lib.docs.iota.org/libraries/nodejs/api_reference.html#addeventlistenerevent-cb">API reference</a>.</p>
<h3 id="5-check-the-account-balance"><a class="header" href="#5-check-the-account-balance">5. Check the account balance</a></h3>
<p>Get the available account balance across all addresses of the given account:</p>
<pre><code class="language-javascript">    // Always sync before account interactions
    console.log('syncing...')
    const synced = await account.sync()
    console.log('synced!')
    let balance = account.balance().available
    console.log('available balance', balance)
</code></pre>
<h3 id="6-enable-withdrawals"><a class="header" href="#6-enable-withdrawals">6. Enable withdrawals</a></h3>
<p>Sending tokens is performed via the <code>SyncedAccount</code> instance that is a result of the <code>account.sync()</code> function:</p>
<pre><code class="language-javascript">    console.log('syncing...')
    const synced = await account.sync()
    console.log('available balance', account.balance().available)

    const address = 'atoi1qykf7rrdjzhgynfkw6z7360avhaaywf5a4vtyvvk6a06gcv5y7sksu7n5cs'

    // TODO: Check if address is valid.

    const amount = 1000000 // Amount in IOTA: 1000000 == 1 MIOTA

    const node_response = await synced.send(
        address,
        amount
    )

    console.log(&quot;Check your message on https://explorer.iota.org/chrysalis/message/&quot;, node_response.id)
</code></pre>
<p>The full function signature is <code>SyncedAccount.send(address, amount[, options])</code>.</p>
<p>Default options are perfectly fine and get the job done; however, additional options can be provided, such as <code>remainderValueStrategy</code>:</p>
<ul>
<li><code>changeAddress</code>: Send the remainder value to an internal address</li>
<li><code>reuseAddress</code>: Send the remainder value back to its original address</li>
</ul>
<p>The <code>SyncedAccount.send()</code> function returns a <code>wallet message</code> that fully describes the given transaction. The <code>messageId</code> can be used later for checking a confirmation status. Individual messages related to the given account can be obtained via <code>account.listMessages()</code> function.</p>
<p>Please note that when sending tokens, a <a href="dev_guide.html#dust-protection">dust protection</a> mechanism should be considered. </p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="../../../../networks/chrysalis-docs/docs/guides/dev_guide.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="../../../../networks/chrysalis-docs/docs/guides/hub_guide.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a rel="prev" href="../../../../networks/chrysalis-docs/docs/guides/dev_guide.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="../../../../networks/chrysalis-docs/docs/guides/hub_guide.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="../../../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../../searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="../../../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
        <script type="text/javascript" src="../../../.././theme/custom/sidebar.js"></script>
        

        

    </body>
</html>
